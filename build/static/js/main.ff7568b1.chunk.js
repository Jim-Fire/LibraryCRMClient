(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{39:function(e,t,a){e.exports=a.p+"static/media/book.43596fee.jpeg"},43:function(e,t,a){e.exports=a(78)},48:function(e,t,a){},52:function(e,t,a){},78:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),o=a(18),s=a.n(o),c=(a(48),a(50),a(6)),l=a(7),i=a(10),u=a(8),d=a(9),p=(a(52),a(12)),m=a(80),h=a(82),b=a(81),f=a(4),g=a(2),E=a(11),O=a.n(E),v=function(e,t){console.log("error data: ",e.response);t({type:"RESPONSE_MESSAGE_ERROR",payload:(e.response&&e.response.data&&e.response.data.message?e.response.data.message:e).toString()}),e&&e.response&&401===e.response.status&&t({type:"SET_UNAUTHORIZATED",payload:!0})};O.a.defaults.headers.common.Authorization=localStorage.getItem("jwt_token");var k=function(e,t){return t({type:"RESPONSE_MESSAGE_SUCCESS",payload:e})},y=function(){return function(e){O.a.get("/get-user").then(function(e){return e.data}).then(function(t){e({type:"USER_GET",payload:t.user})}).catch(function(t){return v(t,e)})}},j=a(22),S=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.props.forceUnmount()},3e3)}},{key:"render",value:function(){var e=this.props,t=e.message,a=e.titleResolve,n=e.titleReject,o=e.resolve,s=e.reject,c=e.type,l=a&&o?r.a.createElement(g.b,{color:"success",onClick:o},a):"",i=n&&s?r.a.createElement(g.b,{color:"danger",onClick:s},n):"",u={};switch(c){case"success":u={border:"3px solid green"};break;case"error":u={border:"3px solid red"};break;default:u={border:"3px solid black"}}return r.a.createElement("div",{className:"simple-modal",style:u},r.a.createElement(g.c,{style:{background:"rgb(0,0,0,0.7)",color:"white"}},r.a.createElement(g.d,null,r.a.createElement(g.g,null,t),l,i)))}}]),t}(n.Component),C=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={messages:[],currentID:0},a.deleteById=a.deleteById.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"deleteById",value:function(e){var t=this.state.messages.filter(function(t){return t.id!==e});this.setState({messages:t})}},{key:"componentWillReceiveProps",value:function(e){e.messageObj&&(console.log("Setting new message... ",e.messageObj),this.setState({messages:Object(j.a)(this.state.messages).concat([{message:e.messageObj.text,type:e.messageObj.type,titleResolve:e.messageObj.titleResolve,titleReject:e.messageObj.titleReject,resolve:e.messageObj.resolve,reject:e.messageObj.reject,id:this.state.currentID}])}),this.setState({currentID:this.state.currentID+1}))}},{key:"render",value:function(){var e=this,t=this.state.messages.map(function(t){return r.a.createElement(S,{key:t.id,message:t.message,type:t.type,titleResolve:t.titleResolve,titleReject:t.titleReject,resolve:function(){"function"===typeof t.resolve&&t.resolve(),e.deleteById(t.id)},reject:function(){"function"===typeof t.reject&&t.reject(),e.deleteById(t.id)},forceUnmount:function(){e.deleteById(t.id)}})});return r.a.createElement("div",{className:"modal-wrapper"},t)}}]),t}(n.Component),w=Object(p.b)(function(e){return{messageObj:e.message.message}},{})(C),B=function(e){var t=e.children;return r.a.createElement(g.k,{className:"app-container auth-container"},r.a.createElement(g.C,{className:"justify-content-center align-items-center"},r.a.createElement(g.i,{xs:6},t)))},N=a(79),_=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={login:"",password:""},a.handleSignIn=a.handleSignIn.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.setUnauthorizated(!1)}},{key:"componentWillReceiveProps",value:function(e){var t=this;e.token&&(console.log("Redirecting to Main page..."),setTimeout(function(){t.props.history.push("/")},100))}},{key:"handleSignIn",value:function(e){e.preventDefault(),this.props.authorizate({login:this.state.login,password:this.state.password})}},{key:"render",value:function(){var e=this;return r.a.createElement(B,null,r.a.createElement(g.o,{className:"auth-form"},r.a.createElement(g.p,null,r.a.createElement(g.r,{for:"exampleEmail"},"Email"),r.a.createElement(g.q,{type:"email",name:"email",id:"exampleEmail",placeholder:"Your email",onChange:function(t){e.setState({login:t.target.value})},value:this.state.login})),r.a.createElement(g.p,null,r.a.createElement(g.r,{for:"examplePassword"},"Password"),r.a.createElement(g.q,{type:"password",name:"password",id:"examplePassword",placeholder:"Your password...",onChange:function(t){e.setState({password:t.target.value})},value:this.state.password})),r.a.createElement(g.p,null,r.a.createElement(g.r,null,"Not Registered?"),r.a.createElement("br",null),r.a.createElement(N.a,{to:"/sign-up"},"Create an accaunt")),r.a.createElement(g.b,{onClick:this.handleSignIn},"Sign in")))}}]),t}(n.Component),R=Object(p.b)(function(e){return{token:e.auth.token}},{authorizate:function(e){var t=e.login,a=e.password;return function(e){O.a.post("/auth",{email:t,password:a}).then(function(e){return e.data}).then(function(t){var a="jwt "+t.token;O.a.defaults.headers.common.Authorization=a,localStorage.setItem("jwt_token",a),localStorage.setItem("user",JSON.stringify(t.user)),e({type:"SIGN_IN",payload:a}),e({type:"USER_GET",payload:t.user}),setTimeout(function(){k(t.message,e)},0)}).catch(function(t){return v(t,e)})}},setUnauthorizated:function(e){var t=e.param;return function(e){e({type:"SET_UNAUTHORIZATED",payload:!!t})}}})(_),D=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={login:"",password:"",passwordConfirm:"",fullname:"",phone:""},a.handleSignUp=a.handleSignUp.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){var t=this;e.user&&(console.log("Redirect to Main page..."),setTimeout(function(){t.props.history.push("/sign-in")},100))}},{key:"handleSignUp",value:function(e){e.preventDefault();var t=this.state,a=t.login,n=t.password,r=t.passwordConfirm,o=t.fullname,s=t.phone;n===r?this.props.register({login:a,password:n,fullname:o,phone:s}):this.props.registerFailed({message:"Your confirm password is not equal password"})}},{key:"render",value:function(){var e=this;return r.a.createElement(B,null,r.a.createElement(g.o,{className:"auth-form"},r.a.createElement(g.p,null,r.a.createElement(g.r,{for:"Email"},"Email"),r.a.createElement(g.q,{type:"email",name:"email",id:"Email",placeholder:"Your email",onChange:function(t){e.setState({login:t.target.value})},value:this.state.login})),r.a.createElement(g.p,null,r.a.createElement(g.r,{for:"Password"},"Password"),r.a.createElement(g.q,{type:"password",name:"password",id:"Password",placeholder:"Your password...",onChange:function(t){e.setState({password:t.target.value})},value:this.state.password})),r.a.createElement(g.p,null,r.a.createElement(g.r,{for:"PasswordConfirm"},"Confirm password"),r.a.createElement(g.q,{type:"password",name:"passwordConfirm",id:"PasswordConfirm",placeholder:"Confirm your password...",onChange:function(t){e.setState({passwordConfirm:t.target.value})},value:this.state.passwordConfirm})),r.a.createElement(g.p,null,r.a.createElement(g.r,{for:"Fullname"},"Fullname"),r.a.createElement(g.q,{type:"text",name:"fullname",id:"Fullname",placeholder:"Your fullname...",onChange:function(t){e.setState({fullname:t.target.value})},value:this.state.fullname})),r.a.createElement(g.p,null,r.a.createElement(g.r,{for:"Phone"},"Phone"),r.a.createElement(g.q,{type:"phone",name:"phone",id:"Phone",placeholder:"Your phone...",onChange:function(t){e.setState({phone:t.target.value})},value:this.state.phone})),r.a.createElement(g.b,{onClick:this.handleSignUp},"Sign Up")))}}]),t}(n.Component),I=Object(p.b)(function(e){return{user:e.auth.user}},{register:function(e){var t=e.login,a=e.password,n=e.fullname,r=e.phone;return function(e){O.a.post("/register",{email:t,password:a,fullname:n,phone:r}).then(function(e){return e.data}).then(function(t){e({type:"SIGN_UP",payload:t.user}),k(t.message,e)}).catch(function(t){return v(t,e)})}},registerFailed:function(e){var t=e.message;return function(e){e({type:"RESPONSE_MESSAGE_ERROR",payload:t})}}})(D),P=1,A=2,T=1,U=2,x=0,L=3;function W(e){return r.a.createElement("div",{onClick:e.handleClick},"CurrentOrder",r.a.createElement(g.a,{color:"primary",style:{marginLeft:"5px"}},+e.booksNumber))}O.a.defaults.headers.common.Authorization=localStorage.getItem("jwt_token");var F=function(){return function(e){O.a.get("/get-books").then(function(e){return e.data}).then(function(t){e({type:"FETCH_BOOKS",payload:t.books})}).catch(function(t){v(t,e)})}};O.a.defaults.headers.common.Authorization=localStorage.getItem("jwt_token");var M=function(e,t){return t({type:"RESPONSE_MESSAGE_SUCCESS",payload:e})},G=a(19),z=a(5),K=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={modal:!1,fields:{}},a.toggle=a.toggle.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){if(this.props.fields&&this.props.fields.length){var e={};this.props.fields.forEach(function(t){e[t.name]=t}),this.setState({fields:e})}}},{key:"toggle",value:function(){this.setState({modal:!this.state.modal})}},{key:"render",value:function(){var e=this,t=[];if(Object.keys(this.state.fields).length){var a=function(a){var n=e.state.fields[a];t.push(r.a.createElement(g.p,{key:n.name},r.a.createElement(g.r,null,n.title),r.a.createElement(g.q,{type:n.type,onChange:function(t){e.setState({fields:Object(z.a)({},e.state.fields,Object(G.a)({},n.name,Object(z.a)({},e.state.fields[n.name],{value:t.target.value})))})},value:e.state.fields[n.name].value})))};for(var n in this.state.fields)a(n)}return r.a.createElement("div",null,r.a.createElement(g.b,{color:this.props.btnColor,onClick:this.toggle},this.props.buttonLabel),r.a.createElement(g.s,{isOpen:this.state.modal,toggle:this.toggle,className:this.props.className},r.a.createElement(g.v,{toggle:this.toggle},this.props.title),r.a.createElement(g.t,null,t),r.a.createElement(g.u,null,r.a.createElement(g.b,{color:"success",onClick:function(){e.toggle();var t={};for(var a in e.state.fields)e.state.fields[a].value&&(t[a]=e.state.fields[a].value);e.props.resolve(t)}},"Ok")," ",r.a.createElement(g.b,{color:"danger",onClick:this.toggle},"Cancel"))))}}]),t}(r.a.Component),q=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).toggle=a.toggle.bind(Object(f.a)(Object(f.a)(a))),a.state={isOpen:!1,booksNubmer:0},a.addBook=a.addBook.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){if(e.orderedBooks){var t=0;e.orderedBooks.forEach(function(e){t+=e.count}),this.setState({booksNubmer:t})}}},{key:"toggle",value:function(){this.setState({isOpen:!this.state.isOpen})}},{key:"addBook",value:function(e){var t=e.name,a=e.author,n=e.pagesNumber,r=e.category,o=e.description,s=e.price,c=e.count;this.props.addBook({name:t,author:a,pagesNumber:n,category:r,description:o,price:s,count:c})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"nav-bar-container"},r.a.createElement(g.z,{color:"light",light:!0,expand:"md"},r.a.createElement(g.A,{href:"#/sign-in"},"Library"),r.a.createElement(g.B,{onClick:this.toggle}),r.a.createElement(g.j,{isOpen:this.state.isOpen,navbar:!0},r.a.createElement(g.w,{className:"ml-auto",navbar:!0},this.props.user&&this.props.user.role===P?r.a.createElement(g.x,null,r.a.createElement(g.y,null,r.a.createElement(W,{booksNumber:this.state.booksNubmer,handleClick:this.props.showCurrentOrder}))):"",r.a.createElement(g.x,null,r.a.createElement(g.y,{onClick:this.props.showBooksCatalog},"Books catalog")),r.a.createElement(g.x,null,r.a.createElement(g.y,{onClick:this.props.showOrders},"Orders")),this.props.user&&this.props.user.role===A?r.a.createElement(g.D,{nav:!0,inNavbar:!0},r.a.createElement(g.n,{nav:!0,caret:!0},"Admin Options"),r.a.createElement(g.m,{right:!0},r.a.createElement(g.l,null,r.a.createElement(K,{buttonLabel:"Add new book",title:"Add new book",resolve:function(t){var a=t.name,n=t.author,r=t.pagesNumber,o=t.category,s=t.description,c=t.price,l=t.count;e.addBook({name:a,author:n,pagesNumber:r,category:o,description:s,price:c,count:l})},btnColor:"primary",fields:[{title:"Name",name:"name",type:"text",value:""},{title:"Author",name:"author",type:"text",value:""},{title:"Pages",name:"pagesNumber",type:"number",value:0},{title:"Category",name:"category",type:"number",value:0},{title:"Description",name:"description",type:"text",value:""},{title:"Price",name:"price",type:"number",value:0},{title:"Count",name:"count",type:"number",value:1}]})),r.a.createElement(g.l,{divider:!0}),r.a.createElement(g.l,null,"Disabled option"))):""))))}}]),t}(r.a.Component),H=Object(p.b)(function(e){return{user:e.auth.user,orderedBooks:e.currentOrder.orderedBooks}},{addBook:function(e){var t=e.name,a=e.author,n=e.pagesNumber,r=e.category,o=e.description,s=e.price,c=e.count;return function(e){O.a.post("/add-book",{name:t,author:a,pagesNumber:n,category:r,description:o,price:s,count:c}).then(function(e){return e.data}).then(function(t){e({type:"ADD_BOOK",payload:t.book}),F()(e),M(t.message,e)}).catch(function(t){return v(t,e)})}}})(q),Y=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(H,{showBooksCatalog:this.props.showBooksCatalog,showOrders:this.props.showOrders,showCurrentOrder:this.props.showCurrentOrder}),r.a.createElement(g.k,{className:"app-container main-container"},r.a.createElement(g.C,{className:"justify-content-center align-items-center"},r.a.createElement(g.i,{xs:10},this.props.children))))}}]),t}(n.Component),J=a(39),X=a.n(J),Z=function(e){return r.a.createElement(g.c,{className:"card-container"},r.a.createElement(g.e,{src:X.a,alt:"Card image cap"}),r.a.createElement(g.d,null,r.a.createElement(g.h,null,e.name),r.a.createElement(g.f,null,"Author: ",e.author),r.a.createElement(g.f,null,"Price: ",e.price),r.a.createElement(g.f,null,"Category: ",e.category),r.a.createElement(g.f,null,"Availability: ",e.count),r.a.createElement(g.g,null,e.description),r.a.createElement("div",{className:"btn-group-custom"},e.role===P?r.a.createElement(K,{buttonLabel:"Buy",title:"Should put this book into order?",resolve:function(t){var a=t.count;a<=e.count?e.addBook({count:a,bookId:e._id}):e.showWarning("Books count must be less than ".concat(e.count+1))},btnColor:"success",fields:[{title:"Count",name:"count",type:"number",value:1}]}):r.a.createElement(r.a.Fragment,null,r.a.createElement(K,{buttonLabel:"Delete book",title:"Should delete this book?",resolve:function(){e.handleDeleteBook(e._id)},btnColor:"danger"}),r.a.createElement(K,{buttonLabel:"Update",title:"Update book",resolve:function(t){var a=t.name,n=t.author,r=t.countPagesNumber,o=t.countCategory,s=t.description,c=t.countPrice,l=t.count,i=e._id;e.handleUpdateBook({bookId:i,name:a,author:n,countPagesNumber:r,countCategory:o,description:s,countPrice:c,count:l})},btnColor:"primary",fields:[{title:"Name",name:"name",type:"text",value:e.name},{title:"Author",name:"author",type:"text",value:e.author},{title:"Pages",name:"countPagesNumber",type:"number",value:e.pagesNumber},{title:"Category",name:"countCategory",type:"number",value:e.category},{title:"Description",name:"description",type:"text",value:e.description},{title:"Price",name:"countPrice",type:"number",value:e.price},{title:"Count",name:"count",type:"number",value:e.count}]})))))},V=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={books:[]},a.handleDeleteBook=a.handleDeleteBook.bind(Object(f.a)(Object(f.a)(a))),a.handleUpdateBook=a.handleUpdateBook.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchBooks()}},{key:"componentWillReceiveProps",value:function(e){e.books&&this.setState({books:e.books})}},{key:"handleDeleteBook",value:function(e){e?this.props.deleteBook({bookId:e}):console.log("Expects _id:",e);var t=this.state.books.filter(function(t){return t._id!==e});this.setState({books:t})}},{key:"handleUpdateBook",value:function(e){var t=e.bookId,a=e.name,n=e.author,r=e.countPagesNumber,o=e.countCategory,s=e.description,c=e.countPrice,l=e.count,i=r,u=o,d=c;t?this.props.updateBook({bookId:t,name:a,author:n,pagesNumber:i,category:u,description:s,price:d,count:l}):console.log("Expects _id:",t);var p=this.state.books.filter(function(e){return e._id!==t});p.unshift({bookId:t,name:a,author:n,pagesNumber:i,category:u,description:s,price:d,count:l}),this.setState({books:p})}},{key:"addBook",value:function(e){var t=e.count,a=e.bookId;if(a){var n={count:t,bookId:a};this.props.addBookIntoOrder({book:n,message:"Books successfully added to current order"})}else console.log("Expects _id",a)}},{key:"showWarning",value:function(e){this.props.showAppWarning(e)}},{key:"render",value:function(){var e=this,t=this.state.books.map(function(t,a){return r.a.createElement("li",{key:a},r.a.createElement(Z,Object.assign({},t,{role:e.props.user.role,showWarning:function(t){e.showWarning(t)},addBook:function(t){var a=t.count,n=t.bookId;e.addBook({count:a,bookId:n})},handleDeleteBook:function(t){e.handleDeleteBook(t)},handleUpdateBook:function(t){var a=t.bookId,n=t.name,r=t.author,o=t.countPagesNumber,s=t.countCategory,c=t.description,l=t.countPrice,i=t.count;e.handleUpdateBook({bookId:a,name:n,author:r,countPagesNumber:o,countCategory:s,description:c,countPrice:l,count:i})}})))}),a=t.length?t:"Loading...";return r.a.createElement("div",{className:"books-catalog-wrapper"},r.a.createElement("ul",null,a))}}]),t}(n.Component),$=Object(p.b)(function(e){return{books:e.data.books,user:e.auth.user}},{fetchBooks:F,getUser:y,deleteBook:function(e){var t=e.bookId;return function(e){O.a.delete("/delete-book/".concat(t)).then(function(e){return e.data}).then(function(t){e({type:"DELETE_BOOK",payload:t.book}),M(t.message,e)}).catch(function(t){return v(t,e)})}},updateBook:function(e){var t=e.bookId,a=e.name,n=e.author,r=e.pagesNumber,o=e.category,s=e.description,c=e.price,l=e.count;return function(e){O.a.put("/update-book/".concat(t),{name:a,author:n,pagesNumber:r,category:o,description:s,price:c,count:l}).then(function(e){return e.data}).then(function(t){e({type:"UPDATE_BOOK",payload:t.book}),M(t.message,e)}).catch(function(t){return v(t,e)})}},showAppWarning:function(e){return function(t){t({type:"SHOW_APP_WARNING",payload:e})}},addBookIntoOrder:function(e){var t=e.book,a=e.message;return function(e){e({type:"ADD_BOOK_INTO_ORDER",payload:t}),e({type:"SHOW_APP_SUCCESS",payload:a})}}})(V),Q=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e,t=this,a=this.props.orderedBooks.map(function(e){return r.a.createElement("li",{key:e.bookDetails._id,className:"ordered-books"},r.a.createElement("div",{className:"book-info-wrapper"},r.a.createElement("span",null,"Name: ",e.bookDetails.name),r.a.createElement("span",null,"Author: ",e.bookDetails.Author),r.a.createElement("span",null,"Count: ",e.count),r.a.createElement("span",null,"Price: ",e.bookDetails.price)))});switch(this.props.status){case U:e=r.a.createElement(g.a,{disabled:!0,color:"warning"},"In progress");break;case L:e=r.a.createElement(g.a,{disabled:!0,color:"primary"},"New order");break;case T:e=r.a.createElement(g.a,{disabled:!0,color:"success"},"Already complited");break;case x:e=r.a.createElement(g.a,{disabled:!0,color:"danger"},"Already rejected");break;default:e="No status found"}return r.a.createElement(g.c,{className:"card-container"},r.a.createElement(g.d,null,r.a.createElement(g.h,null,"Order Number: ",this.props.orderNumber),r.a.createElement(g.g,null,r.a.createElement("b",null,"Summary:")," ",this.props.summary),r.a.createElement(g.g,null,r.a.createElement("b",null,"Status:")," ",e),r.a.createElement(g.g,null,r.a.createElement("b",null,"Description:")," ",this.props.description),this.props.statusDescription?r.a.createElement(g.g,null,r.a.createElement("b",null,"Status Description:")," ",this.props.statusDescription):r.a.createElement(r.a.Fragment,null),a.length?r.a.createElement("ul",null,r.a.createElement("b",null,"Ordered Books:")," ",a):r.a.createElement("b",null,"No books here! ",r.a.createElement("br",null)),r.a.createElement("div",{className:"btn-group-custom"},this.props.role===A?r.a.createElement(r.a.Fragment,null,r.a.createElement(K,{buttonLabel:"Confirm",title:"Confirm order?",resolve:function(e){var a=e.statusDescription;a?t.props.resolveRejectOrder(t.props._id,!0,a):t.props.resolveRejectOrder(t.props._id,!0)},btnColor:"success",fields:[{title:"Description",name:"statusDescription",type:"text",value:""}]}),r.a.createElement(K,{buttonLabel:"Reject",title:"Reject order?",resolve:function(){t.props.resolveRejectOrder(t.props._id,!1)}}),r.a.createElement(K,{buttonLabel:"Delete",title:"Delete order?",resolve:function(){t.props.deleteOrderById(t.props._id)},btnColor:"danger"})):r.a.createElement(r.a.Fragment,null))))}}]),t}(n.Component),ee=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={orders:[],orderStatus:null},a.deleteOrderById=a.deleteOrderById.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){this.props.fetchOrders()}},{key:"componentWillReceiveProps",value:function(e){console.log("Redeived props:",e),e.orders&&this.setState({orders:e.orders}),e.orderStatus!==this.state.orderStatus&&(this.setState({orderStatus:e.orderStatus}),this.props.fetchOrders())}},{key:"deleteOrderById",value:function(e){e?this.props.deleteOrder({id:e}):console.log("Expects _id:",e);var t=this.state.orders.filter(function(t){return t._id!==e});this.setState({orders:t})}},{key:"resolveRejectOrder",value:function(e,t,a){e?this.props.confirmRejectOrder({confirm:t,id:e,statusDescription:a}):console.log("Expects _id:",e)}},{key:"render",value:function(){var e=this;console.log(this.props);var t=this.props.user?this.props.user.role:1,a=this.state.orders.map(function(a){return r.a.createElement("li",{key:a._id},r.a.createElement(Q,Object.assign({},a,{role:t,deleteOrderById:function(t){e.deleteOrderById(t)},resolveRejectOrder:function(t,a,n){e.resolveRejectOrder(t,a,n)}})))}),n=a.length?a:"Loading...";return r.a.createElement("div",{className:"books-catalog-wrapper"},r.a.createElement("ul",null,n))}}]),t}(n.Component),te=Object(p.b)(function(e){return{orders:e.data.orders,user:e.auth.user,orderStatus:e.do.orderStatus}},{fetchOrders:function(){return function(e){O.a.get("/get-orders").then(function(e){return e.data}).then(function(t){e({type:"FETCH_ORDERS",payload:t.orders})}).catch(function(t){return v(t,e)})}},deleteOrder:function(e){var t=e.id;return function(e){O.a.delete("/delete-order/".concat(t),{headers:{"Content-Type":"application/json"}}).then(function(e){return e.data}).then(function(t){e({type:"ORDER_DELETE",payload:t.order}),M(t.message,e)}).catch(function(t){return v(t,e)})}},confirmRejectOrder:function(e){var t=e.confirm,a=e.id,n=e.statusDescription;return function(e){O.a.post("/confirm-reject-order",{confirm:t,id:a,statusDescription:n}).then(function(e){return e.data}).then(function(t){e({type:"ORDER_CONFIRM_REJECT",payload:t.order.status}),M(t.message,e)}).catch(function(t){return v(t,e)})}}})(ee),ae=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={orderNumber:Math.round(1e5*Math.random()),description:"",orderedBooks:[],books:[]},a.resetOrder=a.resetOrder.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"resetOrder",value:function(){this.props.setBooksIntoOrder({orderedBooks:[],message:"Order cleaned!"}),this.setState({description:"",orderedBooks:[]})}},{key:"componentWillReceiveProps",value:function(e){if("block"!==e.showStyle){if(e.orderedBooks){var t=[];this.state.books.forEach(function(a){for(var n=0;n<e.orderedBooks.length;n++)e.orderedBooks[n].bookId===a._id&&t.push({bookId:a._id,name:a.name,author:a.author,price:a.price,count:e.orderedBooks[n].count})}),this.setState({orderedBooks:t})}e.books&&this.setState({books:e.books})}}},{key:"render",value:function(){var e=this,t=this.state.orderedBooks.map(function(e,t){return r.a.createElement("li",{key:t,className:"ordered-books"},r.a.createElement("div",{className:"book-info-wrapper"},r.a.createElement("span",null,"Name: ",e.name),r.a.createElement("span",null,"Author: ",e.author),r.a.createElement("span",null,"Count: ",e.count),r.a.createElement("span",null,"Price: ",e.price)))}),a=0;return this.state.orderedBooks.forEach(function(e){a+=e.price*e.count}),r.a.createElement("div",{className:"books-catalog-wrapper",style:{paddingTop:"15px",display:this.props.showStyle}},r.a.createElement(g.c,{className:"card-container"},r.a.createElement(g.d,null,r.a.createElement("div",null,r.a.createElement(g.p,null,r.a.createElement(g.r,null,"Order Number:"),r.a.createElement(g.q,{type:"number",onChange:function(t){e.setState({orderNumber:t.target.value})},value:this.state.orderNumber}))),r.a.createElement("div",null,"Summary: ",a,"$"),r.a.createElement("div",null,"Status: ",r.a.createElement(g.a,{disabled:!0,color:"warning"},"In progress")),r.a.createElement("div",null,r.a.createElement(g.p,null,r.a.createElement(g.r,null,"Description:"),r.a.createElement(g.q,{type:"textarea",onChange:function(t){e.setState({description:t.target.value})},value:this.state.description}))),t.length?r.a.createElement("ul",null,r.a.createElement("b",null,"Ordered Books:")," ",t):r.a.createElement("b",null,"No books here! ",r.a.createElement("br",null)),r.a.createElement("div",{className:"btn-group-custom"},r.a.createElement(K,{btnColor:"success",buttonLabel:"Confirm order",title:"Confirm order?",resolve:function(){var t=e.state,a=t.orderNumber,n=t.description,r=t.orderedBooks;e.props.createOrder({orderNumber:a,description:n,orderedBooks:r})}}),r.a.createElement(K,{btnColor:"danger",buttonLabel:"Reset",title:"Reset order?",resolve:function(){e.resetOrder()}})))))}}]),t}(n.Component),ne=Object(p.b)(function(e){return{orderedBooks:e.currentOrder.orderedBooks,books:e.data.books}},{createOrder:function(e){var t=e.orderNumber,a=e.description,n=e.orderedBooks;return function(e){O.a.post("/create-order",{orderNumber:t,description:a,orderedBooks:n}).then(function(e){return e.data}).then(function(t){e({type:"ORDER_CREATE",payload:t.order}),M(t.message,e)}).catch(function(t){return v(t,e)})}},setBooksIntoOrder:function(e){var t=e.orderedBooks;e.message;return function(e){e({type:"SET_BOOKS_INTO_ORDER",payload:t})}}})(ae),re=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(i.a)(this,Object(u.a)(t).call(this,e))).state={activeComponent:"BooksCatalog"},a.handleSignIn=a.handleSignIn.bind(Object(f.a)(Object(f.a)(a))),a.showBooksCatalog=a.showBooksCatalog.bind(Object(f.a)(Object(f.a)(a))),a.showOrders=a.showOrders.bind(Object(f.a)(Object(f.a)(a))),a.showCurrentOrder=a.showCurrentOrder.bind(Object(f.a)(Object(f.a)(a))),a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.unauthorizated&&(console.log("Redirecring to login page... "),this.props.history.push("/sign-in"))}},{key:"handleSignIn",value:function(e){e.preventDefault(),this.props.authorizate({login:this.state.login,password:this.state.password})}},{key:"showBooksCatalog",value:function(){this.setState({activeComponent:"BooksCatalog"})}},{key:"showOrders",value:function(){this.setState({activeComponent:"OrdersList"})}},{key:"showCurrentOrder",value:function(){this.setState({activeComponent:"CurrentOrder"})}},{key:"render",value:function(){var e;switch(this.state.activeComponent){case"BooksCatalog":e=r.a.createElement($,null);break;case"OrdersList":e=r.a.createElement(te,null);break;default:e=r.a.createElement(r.a.Fragment,null)}var t="CurrentOrder"===this.state.activeComponent?"block":"none";return r.a.createElement(Y,{showBooksCatalog:this.showBooksCatalog,showOrders:this.showOrders,showCurrentOrder:this.showCurrentOrder},r.a.createElement(ne,{showStyle:t}),e)}}]),t}(n.Component),oe=Object(p.b)(function(e){return{unauthorizated:e.message.unauthorizated}},{getUser:y})(re),se=a(17),ce=a(40),le={books:null,orders:null,users:null},ie={token:null,user:JSON.parse(localStorage.getItem("user"))},ue={user:null,book:null,order:null,orderStatus:null},de={message:{titleResolve:"Ok",text:null},unauthorizated:!1},pe={orderedBooks:[]},me=Object(se.c)({auth:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SIGN_IN":return Object(z.a)({},e,{token:t.payload});case"SIGN_UP":case"USER_GET":return Object(z.a)({},e,{user:t.payload});default:return e}},data:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:le,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_BOOKS":return Object(z.a)({},e,{books:t.payload});case"FETCH_ORDERS":return Object(z.a)({},e,{orders:t.payload});case"USERS_GET":return Object(z.a)({},e,{users:t.payload});default:return e}},do:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"USER_UPDATED":case"USER_DELETED":return Object(z.a)({},e,{user:t.payload});case"ADD_BOOK":case"DELETE_BOOK":case"UPDATE_BOOK":return Object(z.a)({},e,{book:t.payload});case"ORDER_CREATE":case"ORDER_DELETE":return Object(z.a)({},e,{order:t.payload});case"ORDER_CONFIRM_REJECT":return Object(z.a)({},e,{orderStatus:t.payload});default:return e}},message:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:de,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"RESPONSE_MESSAGE_ERROR":return Object(z.a)({},e,{message:Object(z.a)({},e.message,{text:t.payload,type:"error"})});case"RESPONSE_MESSAGE_SUCCESS":return Object(z.a)({},e,{message:Object(z.a)({},e.message,{text:t.payload,type:"success"})});case"SHOW_APP_WARNING":return Object(z.a)({},e,{message:Object(z.a)({},e.message,{text:t.payload,type:"error"})});case"SHOW_APP_SUCCESS":return Object(z.a)({},e,{message:Object(z.a)({},e.message,{text:t.payload,type:"success"})});case"SET_UNAUTHORIZATED":return Object(z.a)({},e,{unauthorizated:t.payload});default:return e}},currentOrder:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_BOOKS_INTO_ORDER":return Object(z.a)({},e,{orderedBooks:t.payload});case"ADD_BOOK_INTO_ORDER":return Object(z.a)({},e,{orderedBooks:Object(j.a)(e.orderedBooks).concat([t.payload])});default:return e}}}),he=[ce.a],be=Object(se.e)(me,{},Object(se.d)(se.a.apply(void 0,he),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())),fe=function(e){function t(){return Object(c.a)(this,t),Object(i.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement(p.a,{store:be},r.a.createElement("div",{className:"App"},r.a.createElement(w,null),r.a.createElement(m.a,null,r.a.createElement(h.a,null,r.a.createElement(b.a,{exact:!0,path:"/",component:oe}),r.a.createElement(b.a,{exact:!0,path:"/sign-in",component:R}),r.a.createElement(b.a,{exact:!0,path:"/sign-up",component:I})))))}}]),t}(n.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[43,2,1]]]);
//# sourceMappingURL=main.ff7568b1.chunk.js.map